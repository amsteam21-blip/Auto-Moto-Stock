var AMOTOS_POPUP=AMOTOS_POPUP||{};!function(t){AMOTOS_POPUP={init:function(){t("select#amotos-shortcodes").selectize(),this.insert_shortcode(),this.select_shortcode()},required_element:function(){var e=t("#options-"+t("#amotos-shortcodes").val());t("[data-required-element]",e).each((function(){var i=t(this).attr("data-required-element"),s=t('[name="'+i+'"]',e),o=function(i,s,o){t('[data-required-element="'+i+'"]',e).each((function(){var e=t(this).closest(".option-item-wrap"),i=t(this).attr("data-required-value");"checkbox"==o?(s.is(":checked")&&"true"===i||!s.is(":checked")&&"false"===i)&&"none"!=s.closest(".option-item-wrap").css("display")?e.show():e.hide():-1!==i.indexOf(s.val())&&"none"!=s.closest(".option-item-wrap").css("display")?e.show():e.hide()})),setTimeout(n,100)},n=function(){t(".two-option-wrap",e).each((function(){var e=!1;t(".option-item-wrap",t(this)).each((function(){"none"!=t(this).css("display")&&(e=!0)})),e?t(this).show():t(this).hide()}))};setTimeout((function(){s.each((function(){var e=t(this),s=e.is("input:checkbox")?"checkbox":"select-one";o(i,e,s)}))}),100),s.off("change").on("change",(function(e){e.preventDefault();var s=t(this);o(i,s,e.target.type)}))}))},update_shortcode:function(){var e=t("#amotos-shortcodes").val(),i="["+e;t("#options-"+e+" input[type=checkbox]").each((function(){"none"!=t(this).closest(".option-item-wrap").css("display")&&(t(this).is(":checked")?i+=" "+t(this).attr("name")+'="true"':i+=" "+t(this).attr("name")+'="false"')})),t("#options-"+e+' select:not("[multiple=multiple]")').each((function(){"none"!=t(this).closest(".option-item-wrap").css("display")&&(i+=" "+t(this).attr("id")+'="'+t(this).val()+'"')})),t("#options-"+e+" select[multiple=multiple]").each((function(){if("none"!=t(this).closest(".option-item-wrap").css("display")){var e=null!=t(this).val()&&t(this).val().length>0?t(this).val():"";i+=" "+t(this).attr("id")+'="'+e+'"'}})),t("#options-"+e+" [data-name=image-upload] input#options-item-id").each((function(){"none"!=t(this).closest(".option-item-wrap").css("display")&&(i+=" "+t(this).attr("name")+'="'+t(this).attr("value")+'"')})),t("#options-"+e+" input[type=text]").each((function(){"none"!=t(this).closest(".option-item-wrap").css("display")&&void 0!==t(this).attr("name")&&(i+=" "+t(this).attr("name")+'="'+t(this).val()+'"')})),i+="]",window.wp.media.editor.insert(i),STUtils.popup.close()},insert_shortcode:function(){t("#insert-shortcode").on("click",(function(){return AMOTOS_POPUP.update_shortcode(),!1}))},select_shortcode:function(){t("#amotos-shortcodes").on("change",(function(){AMOTOS_POPUP.required_element();var e=t(this).val(),i=t("#options-"+e);i.attr("data-type");t(".shortcode-options").hide(),i.show(),AMOTOS_POPUP.reset_fileds()}))},reset_fileds:function(){var e=t("#amotos-input-shortcode").find("#amotos-shortcodes").val(),i=t("#options-"+e);i.find(".amotos-selectize-input").selectize({plugins:["remove_button"],delimiter:",",persist:!1,create:function(t){return{value:t,text:t}}}),i.find("input:text, input:password, input:file, textarea").each((function(){var e=t(this),i=e.attr("data-default-value");void 0!==i?(e.attr("value",i),e.val(i)):(e.attr("value",""),e.val(""))})),i.find('[multiple="multiple"]').val(""),i.find('select:not("#amotos-shortcodes, [multiple=multiple]")').each((function(){var e=t(this),i=e.attr("data-default-value");e.prop("selectedIndex",0),void 0!==i?(e.find('option[value="'+i+'"]').attr("selected","selected"),e.val(i)):e.find("option:first-child").attr("selected","selected")})),i.find("input:checkbox").each((function(){var e=t(this),i=e.attr("data-default-value");void 0!==i&&"true"==i?e.attr("checked","checked"):e.removeAttr("checked")})),i.find(".shortcode-options").each((function(){t(this).find(".shortcode-dynamic-item").addClass("marked-for-removal"),t(this).find(".shortcode-dynamic-item:first").removeClass("marked-for-removal"),t(this).find(".shortcode-dynamic-item.marked-for-removal").remove()})),i.find("#options-item-id").each((function(){t(this).val(""),t(this).attr("value","")})),i.find(".amotos-image-screenshot").attr("src",""),i.find(".amotos-image-upload-remove").hide(),i.find(".amotos-image-upload").show(),i.find(".amotos-selectize-input").each((function(){t(this)[0].selectize&&(t(this)[0].selectize.destroy(),t(this).val("")),t(this).selectize({plugins:["remove_button"],delimiter:",",persist:!1,create:function(t){return{value:t,text:t}}})}))}},t(document).ready((function(){AMOTOS_POPUP.init()}))}(jQuery);