var SQUICK_ImageClass=function(i){this.$container=i};!function(i){"use strict";SQUICK_ImageClass.prototype={init:function(){this.selectMedia()},selectMedia:function(){var e=this,n=e.$container.find(".squick-image-id"),a=e.$container.find(".squick-image-url"),t=e.$container.find(".squick-image-choose-image"),c=e.$container.find(".squick-image-remove"),r=e.$container.find(".squick-image-preview img");(new SQUICK_Media).selectImage(t,{filter:"image"},(function(i){if(i){var t="";t=void 0===i.sizes?i.url:null==i.sizes.thumbnail?i.sizes.full.url:i.sizes.thumbnail.url,r.attr("src",t),r.show(),n.val(i.id),a.val(i.url),e.changeField()}})),c.on("click",(function(){r.attr("src",""),r.hide(),n.val(""),a.val(""),e.changeField()})),a.on("change",(function(){i.ajax({url:SQUICK_META_DATA.ajaxUrl+"?action=squick_get_attachment_id",data:{url:a.val(),_wpnonce:SQUICK_META_DATA.nonce},type:"GET",error:function(){n.val("0"),e.changeField()},success:function(i){n.val(i),e.changeField()}}),""==a.val()?(r.attr("src",""),r.hide()):(r.attr("src",a.val()),r.show())}))},changeField:function(){this.$container.find(".squick-image-id").trigger("squick_field_control_changed"),this.$container.find(".squick-image-id").trigger("change")},getValue:function(){var e={};return this.$container.find("[data-field-control]").each((function(){var n=i(this),a=n.attr("name").replace(/^(.*)(\[)([^\]]*)(\])*$/g,(function(i,e,n,a,t){return a}));e[a]=n.val()})),e}}}(jQuery);