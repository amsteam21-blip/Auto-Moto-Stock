var SQUICK_EditorClass=function(t){this.$container=t};!function(t){"use strict";SQUICK_EditorClass.prototype={init:function(){this.initNotExistEditor()},initNotExistEditor:function(){if(0==this.$container.find(".mce-tinymce").length){var t=this.$container.find(".wp-editor-area"),i=t.attr("id");if("undefined"==typeof tinyMCEPreInit)return;if(!t.closest(".squick-field-clone-item").length)return;if(i in tinyMCEPreInit.mceInit)try{var n=JSON.parse(JSON.stringify(tinyMCEPreInit.mceInit[i]));tinymce.execCommand("mceRemoveEditor",!1,i),tinymce.init(n)}catch(t){}if(i in tinyMCEPreInit.qtInit){var e=JSON.parse(JSON.stringify(tinyMCEPreInit.qtInit[i]));quicktags({id:i,buttons:e.buttons}),QTags._buttonsInit()}}},getValue:function(){return this.$container.find("[data-field-control]").val()}};var i={cloneItem:function(t){var i=t.find(".wp-editor-area"),n=i.attr("name").replace(/[\[\]]/g,"__")+"__editor",e=i.attr("id");if(t.find(".wp-editor-wrap").attr("id","wp-"+n+"-wrap").removeClass("html-active").addClass("tmce-active").find(".wp-editor-tools").attr("id","wp-"+n+"-editor-tools").find(".wp-media-buttons").attr("id","wp-"+n+"-media-buttons").find(".insert-media").data("editor",n),t.find(".switch-tmce").attr("id",n+"-tmce").data("wp-editor-id",n).attr("data-wp-editor-id",n).end().find(".switch-html").attr("id",n+"-html").data("wp-editor-id",n).attr("data-wp-editor-id",n),t.find(".wp-editor-container").attr("id","wp-"+n+"-editor-container").find(".quicktags-toolbar").attr("id","qt_"+n+"_toolbar").html(""),t.find(".wp-editor-container").find(".wp-editor-area").attr("id",n).val(""),e in tinyMCEPreInit.mceInit){var r=JSON.parse(JSON.stringify(tinyMCEPreInit.mceInit[e]));r.body_class=r.body_class.replace(e,n),r.selector=r.selector.replace(e,n),tinyMCEPreInit.mceInit[n]=r,tinymce.execCommand("mceRemoveEditor",!1,n),tinymce.init(r)}if(e in tinyMCEPreInit.qtInit){var o=JSON.parse(JSON.stringify(tinyMCEPreInit.qtInit[e]));quicktags({id:n,buttons:o.buttons}),QTags._buttonsInit()}},onChange:function(i){null==tinymce.editors[i].isChangeEvent&&(tinymce.editors[i].isChangeEvent=!0,tinymce.editors[i].on("change",(function(i){null!=i.lastLevel&&(this.save(),t(this.container).closest(".squick-field-content-inner").find(".wp-editor-area").trigger("squick_field_control_changed"))})))},onChangeEditor:function(){setTimeout((function(){if("undefined"!=typeof tinymce)for(var t=0;t<tinymce.editors.length;t++)i.onChange(t)}),1e3)}};t(document).on("squick_add_clone_field",(function(n){t(n.target).find(".squick-field-editor-inner").length>0&&(i.cloneItem(t(n.target)),i.onChangeEditor())})),t(document).ready((function(){i.onChangeEditor()}))}(jQuery);