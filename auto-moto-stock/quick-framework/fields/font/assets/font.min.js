var SQUICK_FontClass=function(n){this.$container=n};!function(n){"use strict";SQUICK_FontClass.prototype={init:function(){null!=t.googleFonts?this.initFont():t.fontField.push(this)},initFont:function(){var n,e,i,o=this,a=o.$container.find(".squick-font-size-kind"),l=o.$container.find(".squick-font-size-full"),s=o.$container.find(".squick-font-size-value"),f=o.$container.find(".squick-font-size-unit"),r=o.$container.find(".squick-font-family > select"),c=o.$container.find(".squick-font-weight-style > select"),u=o.$container.find(".squick-font-weight"),g=o.$container.find(".squick-font-style"),d=o.$container.find(".squick-font-subsets"),v=o.$container.find(".squick-font-subsets > select"),h="";for(var F in t.googleFonts){for(h+='<optgroup label="'+(n=t.googleFonts[F]).label+'">',i=0;i<n.items.length;i++)h+='<option value="'+(e=n.items[i]).family+'">'+e.family_label+"</option>";h+="</optgroup>"}r.html(h);var p={allowEmptyOption:!0,onChange:function(){var n=t.findFont(r.val());null!=n&&(a.val(n.kind),n.subsets.length>0?(d.show(),o.binderSubsets(n.subsets)):(d.hide(),v.val("")),o.binderFontVariants(n.variants),c.trigger("change")),o.$container.data("init-done")||(c.val(c.data("value")),v.val(v.data("value")),o.$container.data("init-done",!0))}},$=r.selectize(p),b=r.data("value");$[0].selectize.setValue(b),s.on("change",(function(){""==s.val()?l.val(""):l.val(s.val()+f.val()),o.changeField()})),f.on("change",(function(){"em"===f.val()?s.attr("step",.01):s.attr("step",1),""==s.val()?l.val(""):l.val(s.val()+f.val()),o.changeField()})),c.on("change",(function(){var n=c.val(),t=n.replace("italic",""),e=n.substring(t.length);u.val(t),g.val(e),o.changeField()}))},binderSubsets:function(n){var t,e="";for(t=0;t<n.length;t++)e+='<option value="'+n[t]+'">'+n[t]+"</option>";this.$container.find(".squick-font-subsets > select").html(e)},binderFontVariants:function(n){var t,e,i,o,a="";for(t=0;t<n.length;t++)a+='<option value="'+((i=(e=n[t]).replace("italic",""))+(o=e.substring(i.length)))+'">'+i+(""==o?"":" "+o)+"</option>";this.$container.find(".squick-font-weight-style > select").html(a)},changeField:function(){this.$container.find("[data-field-control]").first().trigger("squick_field_control_changed")},getValue:function(){var t={};return this.$container.find("[data-field-control]").each((function(){var e=n(this),i=e.attr("name").replace(/^(.*)(\[)([^\]]*)(\])*$/g,(function(n,t,e,i,o){return i}));t[i]=e.val()})),t}};var t={googleFonts:null,fontField:[],init:function(){n.ajax({url:SQUICK_META_DATA.ajaxUrl,data:{action:"squick_get_fonts",_wpnonce:SQUICK_META_DATA.nonce},success:function(n){t.googleFonts=JSON.parse(n),setTimeout((function(){for(var n=0;n<t.fontField.length;n++)t.fontField[n].initFont()}),50)}})},findFont:function(n){var e,i,o=null;for(e in t.googleFonts)for(i=0;i<t.googleFonts[e].items.length;i++)if((o=t.googleFonts[e].items[i]).family==n)return o;return null}};n(document).ready((function(){t.init()}))}(jQuery);