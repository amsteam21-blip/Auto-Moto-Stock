var SQUICK_BackgroundClass=function(n){this.$container=n};!function(n){"use strict";SQUICK_BackgroundClass.prototype={init:function(){var a=this,c=a.$container.find(".squick-background-color"),e=a.$container.find(".squick-background-choose-image"),i=a.$container.find(".squick-background-remove-image"),o=a.$container.find(".squick-background-url"),t=a.$container.find(".squick-background-image"),r=n.extend({change:function(){n(this);void 0===this.squickIsInitColorChanged?this.squickIsInitColorChanged=!0:setTimeout((function(){a.changeField()}),50)},clear:function(){setTimeout((function(){a.changeField()}),50)}},c.data("options"));c.wpColorPicker(r);var s=new SQUICK_Media;s.selectImage(e,{filter:"image"},(function(c){if(c){n(s.clickedButton).parent();o.val(c.url),t.val(c.id),a.changeField()}})),i.on("click",(function(){o.val(""),t.val(""),a.changePreview(),a.changeField()})),o.on("change",(function(){n.ajax({url:SQUICK_META_DATA.ajaxUrl+"?action=squick_get_attachment_id",data:{url:o.val(),_wpnonce:SQUICK_META_DATA.nonce},type:"GET",error:function(){t.val("0"),a.changeField()},success:function(n){t.val(n),a.changeField()}})})),a.$container.find("[data-field-control]").on("change",(function(){a.changePreview()})),a.changePreview()},getValue:function(){var a={};return this.$container.find("[data-field-control]").each((function(){var c=n(this).attr("name").replace(/^(.*)(\[)([^\]]*)(\])*$/g,(function(n,a,c,e,i){return e}));a[c]=n(this).val()})),a},changeField:function(){this.$container.find(".squick-background-color").trigger("squick_field_control_changed"),this.changePreview()},changePreview:function(){var n=this,a=n.$container.find(".squick-background-color"),c=n.$container.find(".squick-background-preview "),e=n.$container.find(".squick-background-url").val(),i=n.$container.find(".squick-background-repeat").val(),o=n.$container.find(".squick-background-size").val(),t=n.$container.find(".squick-background-position").val(),r=n.$container.find(".squick-background-attachment").val();c.css("background-color",a.val()),""!=e?(c.css("background-image","url("+e+")"),c.css("background-repeat",i),c.css("background-size",o),c.css("background-position",t),c.css("background-attachment",r)):(c.css("background-image",""),c.css("background-repeat",""),c.css("background-size",""),c.css("background-position",""),c.css("background-attachment",""))}}}(jQuery);