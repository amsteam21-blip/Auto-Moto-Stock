var SQUICK_GalleryClass=function(e){this.$container=e};!function(e){"use strict";SQUICK_GalleryClass.prototype={init:function(){this.select(),this.remove(),this.sortable(),this.changeField()},select:function(){var i=new SQUICK_Media,t=this.$container.find(".squick-gallery-add");i.selectGallery(t,{filter:"image"},(function(t){if(t.length){var a=e(i.clickedButton),n=a.parent().find('input[type="hidden"]'),r=n.val(),l=r.split("|"),s="";t.each((function(e){if(e=e.toJSON(),-1==l.indexOf(""+e.id)){""!=r?r+="|"+e.id:r=""+e.id,l.push(""+e.id);var i="";i=null==e.sizes.thumbnail?e.sizes.full.url:e.sizes.thumbnail.url,s+='<div class="squick-gallery-image-preview" data-id="'+e.id+'">',s+='<div class="centered">',s+='<img src="'+i+'" alt=""/>',s+="</div>",s+='<span class="squick-gallery-remove dashicons dashicons dashicons-no-alt"></span>',s+="</div>"}})),n.val(r),n.trigger("change"),a.before(s),a.trigger("squick-gallery-selected")}}))},remove:function(){this.$container.on("click",".squick-gallery-remove",(function(){var i=e(this).parent(),t=i.parent(),a=t.find('input[type="hidden"]');i.remove();var n="";e(".squick-gallery-image-preview",t).each((function(){""!=n?n+="|"+e(this).data("id"):n=""+e(this).data("id")})),a.val(n),a.trigger("change"),t.trigger("squick-gallery-removed")}))},sortable:function(){this.$container.sortable({placeholder:"squick-gallery-sortable-placeholder",items:".squick-gallery-image-preview",update:function(i,t){var a=e(i.target),n="";e(".squick-gallery-image-preview",a).each((function(){""!=n?n+="|"+e(this).data("id"):n=""+e(this).data("id")}));var r=a.find('input[type="hidden"]');r.val(n),r.trigger("change"),a.trigger("squick-gallery-sortable-updated")}})},changeField:function(){var e=this;this.$container.on("squick-gallery-selected squick-gallery-removed squick-gallery-sortable-updated ",(function(i){e.$container.find("[data-field-control]").trigger("squick_field_control_changed")}))},getValue:function(){return this.$container.find("[data-field-control]").val()}}}(jQuery);