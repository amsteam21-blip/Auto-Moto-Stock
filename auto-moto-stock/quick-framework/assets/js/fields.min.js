String.prototype.capitalize=function(){return this.replace(/((^|\s)+)(.)/g,(function(e,i,n,t){return i+t.toUpperCase()}))};var SQUICK=SQUICK||{};!function(e){"use strict";var i=e(document);SQUICK.helper={isCheckBox:function(e){return e.is(":checkbox")},isRadio:function(e){return e.is(":radio")},isText:function(e){return(e.is("input")||e.is("textarea"))&&!this.isCheckBox(e)&&!this.isRadio(e)},isSelect:function(e){return e.is("select")},changeCloneNameIndex:function(e,i,n,t,l,c,o,a){var s=e.closest(".widget-content").length>0,r="";return s&&(r=i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,(function(e,i,n,t,l,c,o,a,s){return i+n+t+l})),i=i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,(function(e,i,n,t,l,c,o,a,s){return o+s}))),i=n&&t?l>=0?c>=0?a?i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,(function(e,i,n,t,a,s,r,d,f,u,h,g,p,k,C,q,v,m){return i+n+l+a+s+r+d+f+c+h+g+p+k+C+o+v+m})):i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,(function(e,i,n,t,o,a,s,r,d,f,u,h){return i+n+l+o+a+s+r+d+c+u+h})):a?i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,(function(e,i,n,t,c,a,s,r,d,f,u,h,g,p,k){return i+n+l+c+a+s+r+d+f+u+h+o+p+k})):i.replace(/^([^\[]+)(\[)([^\]]+)(\])(.*)/g,(function(e,i,n,t,l,c){return i+n+o+l+c})):c>=0?a?i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,(function(e,i,n,t,l,a,s,r,d,f,u,h,g,p,k){return i+n+t+l+a+c+r+d+f+u+h+o+p+k})):i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,(function(e,i,n,t,l,c,a,s,r){return i+n+t+l+c+o+s+r})):i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,(function(e,i,n,t,l,c,a,s,r,d,f,u){return i+n+t+l+c+a+s+r+o+f+u})):n||t?l>=0?a?i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,(function(e,i,n,t,c,a,s,r,d,f,u,h){return i+n+l+c+a+s+r+d+o+u+h})):i.replace(/^([^\[]+)(\[)([^\]]+)(\])(.*)/g,(function(e,i,n,t,l,c){return i+n+o+l+c})):c>=0?a?i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,(function(e,i,n,t,l,a,s,r,d,f,u,h){return i+n+c+l+a+s+r+d+o+u+h})):i.replace(/^([^\[]+)(\[)([^\]]+)(\])(.*)/g,(function(e,i,n,t,l,c){return i+n+o+l+c})):i.replace(/^([^\[]+)(\[)([^\]]+)(\])(\[)([^\]]+)(\])(.*)/g,(function(e,i,n,t,l,c,a,s,r){return i+n+t+l+c+o+s+r})):i.replace(/^([^\[]+)(\[)([^\]]+)(\])(.*)/g,(function(e,i,n,t,l,c){return i+n+o+l+c})),s&&(i=r+"["+i.replace(/^([^\[]+)(\[)(.*)/g,(function(e,i,n,t,l,c){return i+"]"+n+t}))),i}},SQUICK.fields={createFieldObject:function(e,i){if(null==e||""==e)return null;var n="SQUICK_"+e.capitalize()+"Class";return void 0===window[n]?null:new window[n](i)},init:function(){this.timeOutFunc(this.addCloneButtonClick),this.timeOutFunc(this.removeCloneButtonClick),this.timeOutFunc(this.sectionClick),this.timeOutFunc(this.sectionTitleClick),e(document).trigger("squick_before_init_fields"),e(".squick-meta-box-wrap").each((function(){var i=e(this);i.closest("#widgets-left").length||SQUICK.fields.initFields(i)})),e(document).trigger("squick_after_init_fields")},timeOutFunc:function(e){setTimeout(e,1)},initFields:function(e){SQUICK.fields.onChangeFieldControl(e),e.each((function(){SQUICK.required.processApplyField(this)})),SQUICK.required.onChange(e),SQUICK.fields.makeCloneTemplate(e),SQUICK.fields.sortable(e),SQUICK.fields.changePanelTitleEvent(e),SQUICK.fields.stickySection(e),SQUICK.fields.initFieldsDetails(e),e.find(".squick-section-container").first().show(),0==e.find(".squick-sections li.active").length&&e.find(".squick-sections li").first().addClass("active"),SQUICK.fields.initFieldJs(e.find(".squick-section-container").first()),e.find(".squick-meta-box-wrap-loading").addClass("in")},initFieldsDetails:function(i){var n=0==i.find(".squick-section-container").length||0!=e(".squick-term-meta-add-new").length;i.find(".squick-field-content-inner").each((function(){var i=e(this),t=i.closest(".squick-field").data("field-type"),l=SQUICK.fields.createFieldObject(t,i);if(null!=l){this.fieldJs=l;var c=this.fieldJs;n&&setTimeout((function(){c.init(),c.initDone=!0}),1)}}))},initFieldJs:function(e){e.find(".squick-field-content-inner").each((function(){if(null!=this.fieldJs&&null==this.fieldJs.initDone){var e=this;setTimeout((function(){e.fieldJs.init(),e.fieldJs.initDone=!0}),1)}}))},stickySection:function(i){var n=32,t=e(".squick-theme-options-action-inner");t.length&&(n+=t.outerHeight()),i.find(".squick-sections > ul").hcSticky({top:n})},changePanelTitleEvent:function(i){i.find(".squick-field-panel-inner").each((function(i){var n=e(this),t=n.data("panel-title");n.data("panel-title-text",n.find(".squick-field-panel-title-text").html()),null!=t&&""!==t&&n.find("#"+t).find("[data-field-control]").on("change",(function(){SQUICK.fields.changePanelTitle(this)})),i>0&&(n.find(".squick-field-panel-content").hide(),n.closest(".squick-field-panel-clone-item").addClass("in"))})),SQUICK.fields.initPanelTitle(i)},initPanelTitle:function(i){i.find(".squick-field-panel-inner").each((function(){var i=e(this),n=i.data("panel-title");null!=n&&""!==n&&i.find("#"+n).find("[data-field-control]").each((function(){SQUICK.fields.changePanelTitle(this)}))}))},changePanelTitle:function(i){var n=e(i),t=n.closest(".squick-field-panel-inner");""==n.val()?t.find(".squick-field-panel-title-text").html(t.data("panel-title-text")):t.find(".squick-field-panel-title-text").html(n.val())},makeCloneTemplate:function(i){i.find(".squick-field-clone-wrapper").each((function(){var i=e(this),n=i.find("> .squick-field-clone-item").last();n.length>0&&i.data("clone-template",n[0].outerHTML)}))},sectionClick:function(){e(i).on("click",".squick-sections a",(function(i){var n=e(this),t=n.attr("href");if("#"===t[0]){i.preventDefault();var l=e(i.target).closest(".squick-meta-box-wrap"),c=l.find(t);n.closest("ul").find("li").removeClass("active"),n.parent().addClass("active"),l.find(".squick-section-container").hide(),c.show(),SQUICK.fields.initFieldJs(c),n.trigger("squick_section_changed"),l.find(t).find(".squick-map-canvas").each((function(){"undefined"!=typeof google&&void 0!==google.maps&&void 0!==google.maps.event&&void 0!==google.maps.event.trigger&&google.maps.event.trigger(this,"resize")}))}}))},sectionTitleClick:function(){e(document).on("click",".squick-section-title",(function(){var i=e(this);i.toggleClass("in"),i.next().slideToggle();var n=i.closest(".squick-section-container");SQUICK.fields.initFieldJs(n)}))},removeCloneButtonClick:function(){i.on("click",".squick-clone-button-remove",(function(){var i=e(this),n=i.closest(".squick-field-clone-wrapper");i.closest(".squick-field-clone-item").remove(),SQUICK.fields.reIndexCloneField(n)}))},addCloneButtonClick:function(){i.on("click",".squick-clone-button-add",(function(){var i=e(this).parent().find("> .squick-field-clone-wrapper"),n=e(i.data("clone-template"));SQUICK.fields.changeNameBeforeClone(n),i.append(n),SQUICK.fields.reIndexCloneField(i),SQUICK.fields.restoreNameAfterClone(n),SQUICK.fields.initFields(n),SQUICK.fields.onChangeFieldControl(n),SQUICK.required.onChange(n),n.trigger("squick_add_clone_field"),n.find(".squick-field").trigger("squick_check_required")}))},changeNameBeforeClone:function(i){i.find("[data-field-control]").each((function(){var i=e(this),n=i.attr("name");null!=n&&0!==n.indexOf("____")&&i.attr("name","____"+n)}))},restoreNameAfterClone:function(i){i.find("[data-field-control]").each((function(){var i=e(this),n=i.attr("name");null!=n&&0===n.indexOf("____")&&(n=n.substring(4),i.attr("name",n))}))},onChangeFieldControl:function(i){i.find("[data-field-control]").on("change",(function(){e(this).trigger("squick_field_control_changed")})),i.on("squick_field_control_changed",(function(i){var n=e(i.target);if(n.data("field-no-change"))n.data("field-no-change",!1);else if(!n.data("field-set-value")){var t=n.closest(".squick-field"),l=SQUICK.fields.getValue(t);t.data("field-value",l),t.trigger("squick_check_required"),t.trigger("squick_check_preset"),t.trigger("squick_field_change")}}))},reIndexCloneField:function(i){i.find("> .squick-field-clone-item").each((function(i){var n=e(this);n.data("clone-index",i),n.find("[data-field-control]").each((function(){var n=e(this),t=n.attr("name");if(null!=t||""!==t){var l=n.closest(".squick-field").find(".squick-field-clone-item").length,c=n.closest(".squick-field-repeater-clone-item").data("clone-index");null!=c&&""!==c||(c=-1);var o=n.closest(".squick-field-panel-clone-item").data("clone-index");null!=o&&""!==o||(o=-1);var a=n.closest(".squick-field-panel").length>0,s=n.closest(".squick-field-repeater").length>0;t=SQUICK.helper.changeCloneNameIndex(n,t,a,s,o,c,i,l),n.attr("name",t)}}))}))},sortable:function(i){i.find(".squick-field-clone-wrapper").sortable({items:".squick-field-clone-item",placeholder:"squick-field-clone-sortable-placeholder",handle:".squick-sortable-button,.squick-field-panel-title.squick-field-panel-title-sortable",cancel:".squick-clone-button-remove,.squick-field-panel-title-toggle",update:function(i,n){var t=e(i.target);SQUICK.fields.reIndexCloneField(t)},stop:function(i,n){n.item.find("textarea.wp-editor-area").each((function(i,n){var t,l;if(t=tinyMCE.EditorManager.get(n.id),l=e(this).parents(".tmce-active").length,t&&l){e(this).parent().find(" > .mce-container").remove(),e("#"+n.id).val(t.getContent()),e("#"+n.id).show();var c=tinyMCEPreInit.mceInit[n.id];tinymce.init(c)}}))}})},clearFieldValue:function(i){i.find("[data-field-control]").each((function(){var i=e(this);i.closest(".squick-field").data("field-value",""),SQUICK.helper.isSelect(i)?i.prop("selectedIndex",0):SQUICK.helper.isCheckBox(i)||SQUICK.helper.isRadio(i)?i.prop("checked",!1):i.val("")}))},getValue:function(i){var n="";if(i.find(".squick-field-clone-item").length>0)n=[],i.find(".squick-field-clone-item").each((function(){var i=e(this).find("> .squick-field-content-inner");n.push(null!=i[0].fieldJs?i[0].fieldJs.getValue():"")}));else{var t=i.find(".squick-field-content-inner");t.length&&null!=t[0].fieldJs&&(n=t[0].fieldJs.getValue())}return n}},SQUICK.group={init:function(){this.toggleGroup()},toggleGroup:function(){i.on("click",".squick-field-group-title",(function(i){var n=e(i.target).closest(".squick-field-group");n.toggleClass("in"),n.find("> .squick-field-group-content").slideToggle((function(){e(this).closest(".squick-meta-box-wrap").find(".squick-sections > ul").hcSticky("refresh")}))}))}},SQUICK.panel={init:function(){this.togglePanel()},togglePanel:function(){i.on("click",".squick-field-panel-title",(function(i){var n=e(i.target),t=n.closest(".squick-field-panel-clone-item");if(!n.closest(".squick-clone-button-remove").length)if(n.closest(".squick-field-panel-clone").find(".squick-field-panel-clone-item").each((function(){0!=t.length&&this==t[0]||(e(this).find(".squick-field-panel-content").slideUp(),e(this).addClass("in"))})),t.length)t.toggleClass("in"),t.find(".squick-field-panel-content").slideToggle();else{var l=n.closest(".squick-field-panel");l.toggleClass("in"),l.find(".squick-field-panel-content").slideToggle()}}))},sortable:function(){}},SQUICK.required={processApplyField:function(i){var n=[];e(i).find(".squick-field[data-required]").each((function(){var i,t,l,c,o,a,s,r=e(this),d=r.data("required"),f=r.attr("id");if(e.isArray(d[0]))for(i=0;i<d.length;i++)if(l=d[i],e.isArray(l[0]))for(t=0;t<l.length;t++)o=(c=l[t])[0],a=c[1],s=c[2],-1!=o.indexOf("[")&&(o=o.replace(/\[.*/i,"")),void 0===n[o]&&(n[o]=[]),-1===n[o].indexOf(f)&&n[o].push(f),"&"===a[0]&&(void 0===n[s]&&(n[s]=[]),-1===n[s].indexOf(f)&&n[s].push(f));else o=l[0],a=l[1],s=l[2],-1!=o.indexOf("[")&&(o=o.replace(/\[.*/i,"")),void 0===n[o]&&(n[o]=[]),-1===n[o].indexOf(f)&&n[o].push(f),"&"===a[0]&&(void 0===n[s]&&(n[s]=[]),-1===n[s].indexOf(f)&&n[s].push(f));else o=d[0],a=d[1],s=d[2],-1!=o.indexOf("[")&&(o=o.replace(/\[.*/i,"")),void 0===n[o]&&(n[o]=[]),-1===n[o].indexOf(f)&&n[o].push(f),"&"===a[0]&&(void 0===n[s]&&(n[s]=[]),-1===n[s].indexOf(f)&&n[s].push(f))})),i.applyFieldRequired=n},onChange:function(e){e.find(".squick-field").on("squick_check_required",SQUICK.required.onChangeEvent)},onChangeEvent:function(i){if(this==i.target){var n=e(this),t=n.closest(".squick-meta-box-wrap"),l=t[0].applyFieldRequired,c=n.attr("id"),o=n.closest(".squick-field-panel-inner");if(null!=l&&void 0!==n.data("field-value")&&void 0!==l[c])for(var a=0;a<l[c].length;a++)o.length?SQUICK.required.toggleField(o.find('[id="'+l[c][a]+'"]'),o,t):SQUICK.required.toggleField(t.find('[id="'+l[c][a]+'"]'),o,t)}},toggleField:function(i,n,t){var l=i.data("required");(e.isArray(l[0])?SQUICK.required.andCondition(l,n,t):SQUICK.required.processField(l,n,t))?i.slideDown():i.slideUp()},andCondition:function(i,n,t){var l,c;for(c=0;c<i.length;c++)if(l=i[c],e.isArray(l[0])){if(!SQUICK.required.orCondition(l,n,t))return!1}else if(!SQUICK.required.processField(l,n,t))return!1;return!0},orCondition:function(e,i,n){var t,l;for(l=0;l<e.length;l++)if(t=e[l],SQUICK.required.processField(t,i,n))return!0;return!1},processField:function(i,n,t){var l,c=i[0],o=i[1],a=i[2],s="";if(-1!=c.indexOf("[")){var r=c.replace(/\[.*/i,"");s=(s=c.substring(r.length)).substr(1,s.length-2),c=r}switch(l=n.length?n.find('[id="'+c+'"]').data("field-value"):t.find('[id="'+c+'"]').data("field-value"),""!==s&&void 0!==l[s]&&(l=l[s]),"&"===o.substr(0,1)&&(a=n.length?n.find("#"+a).data("field-value"):e("#"+a).data("field-value")),o){case"=":case"&=":return a==l;case"!=":case"&!=":return a!=l;case"in":case"&in":return a==l||e.isArray(a)&&-1!=a.indexOf(l);case"not in":case"&not in":return!e.isArray(a)&&a!=l||-1==a.indexOf(l);case"contain":case"&contain":return a==l||e.isArray(l)&&-1!=l.indexOf(a)||"object"==typeof l&&null!=l&&a in l;case"not contain":case"&not contain":return null==l||e.isArray(l)&&-1==l.indexOf(a)||"object"==typeof l&&!(a in l)||!e.isArray(l)&&"object"!=typeof l&&l!=a}return!1}},SQUICK.preset={init:function(){this.onCheckPreset()},onCheckPreset:function(){e(document).on("squick_check_preset",".squick-field",(function(i){if(this==i.target){var n=e(this),t=n.closest(".squick-field-panel-inner");if(0===t.length&&(t=e(".squick-meta-box-wrap")),void 0!==n.data("field-value")){var l=n.data("preset");if(void 0!==l){var c,o,a,s,r,d=n.data("field-value");for(c=0;c<l.length;c++)if(a=l[c].op,s=l[c].value,r=l[c].fields,"="===a&&s==d||"!="===a&&s!=d){for(o=0;o<r.length;o++){var f=t.find("#"+r[o][0]),u=f.find("[data-field-control]");if(f.length>0&&f[0]!=this)if("object"==typeof r[o][1])for(var h in r[o][1])f.find('[name$="['+h+']"]').val(r[o][1][h]);else SQUICK.helper.isRadio(u)||SQUICK.helper.isCheckBox(u)?f.find('[data-field-control][value="'+r[o][1]+'"]').prop("checked",!0):u.val(r[o][1]);u.trigger("squick_preset_change",r[o][1]),u.trigger("change")}break}}}}}))}},SQUICK.onReady={init:function(){SQUICK.fields.init(),SQUICK.group.init(),SQUICK.panel.init(),SQUICK.preset.init(),e(".squick-field").trigger("squick_check_required")}},SQUICK.onResize={init:function(){}},i.ready(SQUICK.onReady.init),e(window).resize(SQUICK.onResize.init)}(jQuery);