var AMOTOS_Car_Advanced_Search=AMOTOS_Car_Advanced_Search||{};!function(a){"use strict";var t="",e="",r=".amotos-car-advanced-search";AMOTOS_Car_Advanced_Search={init:function(){0!==a(r).length&&(void 0!==a(r).data("options")&&(window.amotos_car_advanced_search_vars=a(r).data("options")),"undefined"!=typeof amotos_car_advanced_search_vars&&(t=amotos_car_advanced_search_vars.ajax_url,e=amotos_car_advanced_search_vars.price_is_slider,"1"==amotos_car_advanced_search_vars.enable_filter_location&&(a(".amotos-car-country-ajax",r).select2(),a(".amotos-car-state-ajax",r).select2(),a(".amotos-car-city-ajax",r).select2(),a(".amotos-car-neighborhood-ajax",r).select2()),this.get_states_by_country(),a(".amotos-car-country-ajax",r).on("change",(function(){AMOTOS_Car_Advanced_Search.get_states_by_country()})),this.get_cities_by_state(),a(".amotos-car-state-ajax",r).on("change",(function(){AMOTOS_Car_Advanced_Search.get_cities_by_state()})),this.get_neighborhoods_by_city(),a(".amotos-car-city-ajax",r).on("change",(function(){AMOTOS_Car_Advanced_Search.get_neighborhoods_by_city()})),a(".btn-status-filter",r).on("click",(function(t){t.preventDefault();var e=a(this).data("value");a(this).parent().find("input").val(e),a(this).parent().find("button").removeClass("active"),a(this).addClass("active"),AMOTOS_Car_Advanced_Search.change_price_on_status_change(e)})),a('select[name="status"]',r).on("change",(function(t){t.preventDefault();var e=a(this).val();AMOTOS_Car_Advanced_Search.change_price_on_status_change(e)})),this.execute_url_search(),a(".amotos-sliderbar-filter.amotos-sliderbar-price",r).on("register.again",(function(){a(".amotos-sliderbar-filter.amotos-sliderbar-price",r).each((function(){var t=a(this);AMOTOS_Car_Advanced_Search.set_slider_filter(t)}))})),this.register_slider_filter(),this.set_slider_value()))},get_states_by_country:function(){var e=a(".amotos-car-country-ajax",r);if(e.length){var s=e.val();a.ajax({type:"POST",url:t,data:{action:"amotos_get_states_by_country_ajax",country:s,type:1,is_slug:"1"},success:function(t){a(".amotos-car-state-ajax",r).html(t);var e=a(".amotos-car-state-ajax",r).attr("data-selected");void 0!==e&&a(".amotos-car-state-ajax",r).val(e)}})}},get_cities_by_state:function(){var e=a(".amotos-car-state-ajax",r);if(e.length){var s=e.val();a.ajax({type:"POST",url:t,data:{action:"amotos_get_cities_by_state_ajax",state:s,type:1,is_slug:"1"},success:function(t){a(".amotos-car-city-ajax",r).html(t);var e=a(".amotos-car-city-ajax",r).attr("data-selected");void 0!==e&&a(".amotos-car-city-ajax",r).val(e)}})}},get_neighborhoods_by_city:function(){var e=a(".amotos-car-city-ajax",r);if(e.length){var s=e.val();a.ajax({type:"POST",url:t,data:{action:"amotos_get_neighborhoods_by_city_ajax",city:s,type:1,is_slug:"1"},success:function(t){a(".amotos-car-neighborhood-ajax",r).html(t);var e=a(".amotos-car-neighborhood-ajax",r).attr("data-selected");void 0!==e&&a(".amotos-car-neighborhood-ajax",r).val(e)}})}},execute_url_search:function(){a(".amotos-advanced-search-btn",r).on("click",(function(t){t.preventDefault();var e=a(this).closest(".search-cars-form"),r=e.data("href"),s=[],i="?";-1!==r.indexOf("?")&&(i="&"),a(".search-field",e).each((function(){var t=a(this),e=t.attr("name"),r=t.val();r!=t.data("default-value")&&(s[e]=r)})),a(".amotos-sliderbar-filter",e).each((function(){var t=a(this),e=t.find(".min-input-request").attr("name"),r=t.find(".max-input-request").attr("name"),i=t.find(".min-input-request").val(),n=t.find(".max-input-request").val(),c=t.data("min-default"),_=t.data("max-default");i==c&&n==_||(s[e]=i,s[r]=n)}));var n="";if(a('[name="other_stylings"]',e).each((function(){var t=a(this),e=t.attr("value");t.is(":checked")&&(n+=e+";")})),""!==n&&(n=n.substring(0,n.length-1),s.other_stylings=n),s!==[])for(var c in s)s.hasOwnProperty(c)&&(i+=c+"="+encodeURIComponent(s[c])+"&");i=i.substring("0",i.length-1),window.location.href=r+i}))},set_slider_filter:function(a){var t,e,r=a,s=parseInt(r.attr("data-min-default")),i=parseInt(r.attr("data-max-default")),n=r.attr("data-min"),c=r.attr("data-max"),_=r.find(".sidebar-filter"),d="",l="";_.slider({min:s,max:i,range:!0,values:[n,c],slide:function(a,s){t=s.values[0],e=s.values[1],r.attr("data-min",t),r.attr("data-max",e),r.find("input.min-input-request").attr("value",t),r.find("input.max-input-request").attr("value",e),r.find("span").hasClass("not-format")?(d=t,l=e):(d=AMOTOS.number_format(t),l=AMOTOS.number_format(e)),r.hasClass("amotos-sliderbar-price")&&("before"===amotos_main_vars.currency_position?(d=amotos_main_vars.currency+d,l=amotos_main_vars.currency+l):(d+=amotos_main_vars.currency,l+=amotos_main_vars.currency)),r.find("span.min-value").html(d),r.find("span.max-value").html(l)},stop:function(a,t){}})},register_slider_filter:function(){a(".amotos-sliderbar-filter",r).each((function(){var t=a(this);AMOTOS_Car_Advanced_Search.set_slider_filter(t)}))},set_slider_value:function(){a(".amotos-sliderbar-filter",r).each((function(){var t=a(this),e=t.attr("data-min-default"),r=t.attr("data-max-default"),s=t.attr("data-min"),i=t.attr("data-max"),n=(s-e)/(r-e)*100+"%",c=(i-s)/(r-e)*100+"%",_=(i-e)/(r-e)*100+"%";t.find(".ui-slider-range.ui-corner-all.ui-widget-header").css({left:n,width:c}),t.find(".ui-slider-handle.ui-corner-all.ui-state-default").css("left",n),t.find(".ui-slider-handle.ui-corner-all.ui-state-default:last-child").css("left",_)}))},change_price_on_status_change:function(s){a.ajax({type:"POST",url:t,dataType:"json",data:{action:"amotos_ajax_change_price_on_status_change",status:s,price_is_slider:e},success:function(t){t.slide_html?(a(".amotos-sliderbar-price-wrap",r).html(t.slide_html),AMOTOS_Car_Advanced_Search.register_slider_filter(),AMOTOS_Car_Advanced_Search.set_slider_value()):(t.min_price_html&&a('select[name="min-price"]',r).html(t.min_price_html),t.max_price_html&&a('select[name="max-price"]',r).html(t.max_price_html))}})}},a(document).ready((function(){a("body").hasClass("elementor-editor-active")||AMOTOS_Car_Advanced_Search.init()}))}(jQuery);