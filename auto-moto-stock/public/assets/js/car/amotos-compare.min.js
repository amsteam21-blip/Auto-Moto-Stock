var AMOTOS_Compare=AMOTOS_Compare||{};!function(a){"use strict";if("undefined"!=typeof amotos_compare_vars)var s=amotos_compare_vars.ajax_url,e=amotos_compare_vars.compare_button_url,n=amotos_compare_vars.alert_title,i=amotos_compare_vars.alert_message,r=amotos_compare_vars.alert_not_found,o=a("#compare-listings"),l=a(".compare-car","#compare-cars-listings").length;AMOTOS_Compare={init:function(){this.register_event_compare(),this.compare_car(),this.open_compare(),this.close_compare(),this.compare_listing()},register_event_compare:function(){a(document).on("click","a.compare-car",(function(e){if(!a(this).hasClass("on-handle")){e.preventDefault();var r=a(this).addClass("on-handle"),o=r.closest(".car-inner").addClass("car-active-hover"),t=r.data("car-id");a(".listing-btn").removeClass("hidden"),4==l?r.children().hasClass("plus")?(l--,r.find("i.fa-minus").removeClass("fa-minus").addClass("fa-spinner fa-spin")):AMOTOS.popup_alert("fa fa-check-squaere-o",n,i):r.children().hasClass("plus")?(l--,r.find("i.fa-minus").removeClass("fa-minus").addClass("fa-spinner fa-spin")):(l++,r.find("i.fa-plus").removeClass("fa-plus").addClass("fa-spinner fa-spin minus")),a.ajax({url:s,method:"post",data:{action:"amotos_compare_add_remove_car_ajax",car_id:t},success:function(s){r.children().hasClass("minus")?r.find("i.minus").removeClass("fa-spinner fa-spin minus").addClass("fa-minus plus"):r.find("i.fa-spinner").removeClass("fa-spinner fa-spin plus").addClass("fa-plus"),a("div#compare-cars-listings").replaceWith(s),AMOTOS_Compare.compare_listing(),0==l?(a(".listing-btn").addClass("hidden"),AMOTOS_Compare.close_compare()):AMOTOS_Compare.open_compare(),r.removeClass("on-handle"),o.removeClass("car-active-hover")}})}}))},compare_listing:function(){a(".listing-btn").off("click").on("click",(function(){o.hasClass("listing-open")?(o.removeClass("listing-open"),a(".listing-btn").find("i.fa-angle-right").removeClass("fa-angle-right").addClass("fa-angle-left")):(o.addClass("listing-open"),a(".listing-btn").find("i.fa-angle-left").removeClass("fa-angle-left").addClass("fa-angle-right"))}))},open_compare:function(){o.addClass("listing-open"),a(".listing-btn").find("i.fa-angle-left").removeClass("fa-angle-left").addClass("fa-angle-right")},close_compare:function(){o.hasClass("listing-open")&&(o.removeClass("listing-open"),a(".listing-btn").find("i.fa-angle-right").removeClass("fa-angle-right").addClass("fa-angle-left"))},compare_car:function(){if(1==o.length&&(a("div.compare-car").each((function(){var s=a(this).attr("data-car-id"),e=a("a[data-car-id='"+s+"']");a("i.fa-plus",e).removeClass("fa-plus").addClass("fa-minus plus")})),AMOTOS_Compare.compare_listing(),a(".compare-car").length>0)){AMOTOS_Compare.register_event_compare(l);var n=!0;a(document).on("click","#compare-cars-listings .compare-car-remove",(function(e){if(e.preventDefault(),n){n=!1;var i=a(this),r=i.parent().attr("data-car-id"),o=a("a[data-car-id='"+r+"']");i.parent().addClass("remove"),a("i.plus",o).removeClass("fa-minus plus").addClass("fa-plus"),0==--l&&(a("#compare-cars-listings").addClass("hidden"),a(".listing-btn").addClass("hidden"),AMOTOS_Compare.close_compare()),a.ajax({url:s,method:"post",data:{action:"amotos_compare_add_remove_car_ajax",car_id:r},success:function(s){a("div#compare-cars-listings").replaceWith(s),AMOTOS_Compare.compare_listing(),0==l?(a(".listing-btn").addClass("hidden"),AMOTOS_Compare.close_compare()):AMOTOS_Compare.open_compare(),n=!0},error:function(){n=!0}})}})),a(document).on("click",".compare-cars-button",(function(){return""!=e?window.location.href=e:alert(r),!1}))}}},a(document).ready((function(){AMOTOS_Compare.init()}))}(jQuery);