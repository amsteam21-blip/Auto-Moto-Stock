!function(e){"use strict";var s={init:function(){this.cacheDOM(),this.setupAria(),this.nextButton(),this.prevButton(),this.validateForm(),this.editForm(),this.killEnterKey(),this.handleStepClicks()},cacheDOM:function(){this.$formParent=e(".amotos-car-multi-step"),this.$form=this.$formParent.find("form"),this.$formStepParents=this.$form.find("fieldset"),this.$nextButton=this.$form.find(".amotos-btn-next"),this.$prevButton=this.$form.find(".amotos-btn-prev"),this.$editButton=this.$form.find(".amotos-btn-edit"),this.$stepsParent=e(".amotos-steps"),this.$steps=this.$stepsParent.find("button")},htmlClasses:{activeClass:"active",hiddenClass:"hidden",visibleClass:"visible",editFormClass:"edit-form",animatedVisibleClass:"animated fadeIn",animatedHiddenClass:"animated fadeOut",animatingClass:"animating"},setupAria:function(){this.$formStepParents.eq(0).attr("aria-hidden",!1),this.$formStepParents.not(":first").attr("aria-hidden",!0),s.handleAriaExpanded()},nextButton:function(){this.$nextButton.on("click",(function(a){a.preventDefault();var t=e(this).closest("fieldset"),r=t.next();s.checkForValidForm()&&(t.removeClass(s.htmlClasses.visibleClass),s.showNextStep(t,r))}))},prevButton:function(){this.$prevButton.on("click",(function(a){a.preventDefault();var t=e(this).closest("fieldset"),r=t.prev();t.removeClass(s.htmlClasses.visibleClass),s.showPrevStep(t,r)}))},showNextStep:function(e,a){e.addClass(s.htmlClasses.hiddenClass).attr("aria-hidden",!0),a.removeClass(s.htmlClasses.hiddenClass).addClass(s.htmlClasses.visibleClass).attr("aria-hidden",!1),a.focus(),s.handleState(a.index()),s.handleAriaExpanded()},showPrevStep:function(e,a){e.addClass(s.htmlClasses.hiddenClass).attr("aria-hidden",!0),a.removeClass(s.htmlClasses.hiddenClass).addClass(s.htmlClasses.visibleClass).attr("aria-hidden",!1),a.focus(),s.handleState(a.index()),s.handleAriaExpanded()},handleAriaExpanded:function(){e.each(this.$nextButton,(function(s,a){var t=e(a).attr("aria-controls");"true"==e("#"+t).attr("aria-hidden")?e(a).attr("aria-expanded",!1):e(a).attr("aria-expanded",!0)})),e.each(this.$prevButton,(function(s,a){var t=e(a).attr("aria-controls");"true"==e("#"+t).attr("aria-hidden")?e(a).attr("aria-expanded",!1):e(a).attr("aria-expanded",!0)}))},checkFieldRequired:function(e){return 1==e},validateForm:function(){var s=amotos_car_steps_vars.car_title,a=amotos_car_steps_vars.car_price,t=amotos_car_steps_vars.car_type,r=amotos_car_steps_vars.car_status,i=amotos_car_steps_vars.car_label,d=amotos_car_steps_vars.car_price_prefix,n=amotos_car_steps_vars.car_price_postfix,l=amotos_car_steps_vars.car_doors,c=amotos_car_steps_vars.car_seats,h=amotos_car_steps_vars.car_owners,o=amotos_car_steps_vars.car_mileage,u=amotos_car_steps_vars.car_power,_=amotos_car_steps_vars.car_volume,m=amotos_car_steps_vars.car_year,p=amotos_car_steps_vars.car_address,v=amotos_car_steps_vars.car_country,f=amotos_car_steps_vars.state,C=amotos_car_steps_vars.city,q=amotos_car_steps_vars.neighborhood,b=amotos_car_steps_vars.postal_code;this.$form.validate({ignore:":hidden",errorElement:"div",invalidHandler:function(s,a){e.each(a.errorList,(function(s,a){0===s&&e(a.element).focus(),e(a.element).attr("aria-invalid",!0)}))},highlight:function(s,a,t){var r=e(s);r.hasClass("select2-hidden-accessible")?r.parent().find(".select2-container").addClass(a).removeClass(t):r.addClass(a).removeClass(t)},unhighlight:function(s,a,t){var r=e(s);r.hasClass("select2-hidden-accessible")?r.parent().find(".select2-container").removeClass(a).addClass(t):r.removeClass(a).addClass(t)},rules:{car_title:{required:this.checkFieldRequired(s)},car_price_short:{required:this.checkFieldRequired(a)},"car_type[]":{required:this.checkFieldRequired(t)},"car_status[]":{required:this.checkFieldRequired(r)},"car_label[]":{required:this.checkFieldRequired(i)},car_price_prefix:{required:this.checkFieldRequired(d)},car_price_postfix:{required:this.checkFieldRequired(n)},car_mileage:{required:this.checkFieldRequired(o),number:!0},car_power:{required:this.checkFieldRequired(u),number:!0},car_volume:{required:this.checkFieldRequired(_),number:!0},car_doors:{required:this.checkFieldRequired(l),number:!0},car_seats:{required:this.checkFieldRequired(c),number:!0},car_owners:{required:this.checkFieldRequired(h),number:!0},car_year:{required:this.checkFieldRequired(m),number:!0},car_map_address:{required:this.checkFieldRequired(p)},car_country:{required:this.checkFieldRequired(v)},administrative_area_level_1:{required:this.checkFieldRequired(f)},locality:{required:this.checkFieldRequired(C)},neighborhood:{required:this.checkFieldRequired(q)},postal_code:{required:this.checkFieldRequired(b)}},messages:{car_title:"",car_des:"",car_price_short:"",car_doors:"",car_seats:"",car_owners:"",car_mileage:"",car_map_address:"","car_type[]":"","car_status[]":"","car_label[]":"",car_price_prefix:"",car_price_postfix:"",car_power:"",car_volume:"",car_year:"",car_country:"",administrative_area_level_1:"",locality:"",neighborhood:"",postal_code:""},submitHandler:function(e){e.submit()}}),e(document).on("select2:select select2:unselect","#car_type,#car_status,#car_label",(function(s){var a=e(s.target);null===a.val()?a.parent().find(".select2-container").addClass("error"):a.parent().find(".select2-container").removeClass("error")})),e('[data-toggle="amotos-car-additional-field-required"]').each((function(){var s=e(this).attr("data-name");void 0===s&&(s=e(this).attr("name"));var a=e('[name="'+s+'"]');a.length>0&&a.rules("add",{required:!0,messages:{required:""}})}))},checkForValidForm:function(){if(this.$form.valid())return!0},handleState:function(e){this.$steps.eq(e).prevAll().removeAttr("disabled"),this.$steps.eq(e).addClass(s.htmlClasses.activeClass),0===e&&(this.$steps.removeClass(s.htmlClasses.activeClass).attr("disabled","disabled"),this.$steps.eq(0).addClass(s.htmlClasses.activeClass))},editForm:function(){var e=this.$formParent,a=this.$formStepParents;this.$stepsParent;this.$editButton.on("click",(function(){e.toggleClass(s.htmlClasses.editFormClass),a.attr("aria-hidden",!1),a.eq(0).find("input").eq(0).focus(),s.handleAriaExpanded()}))},killEnterKey:function(){e(document).on("keypress",":input:not(textarea,button)",(function(e){return 13!=e.keyCode}))},handleStepClicks:function(){var a=this.$steps,t=this.$formStepParents;a.on("click",(function(r){r.preventDefault();var i=e(this).index();a.nextAll().removeClass(s.htmlClasses.activeClass).attr("disabled",!0),e(this).addClass(s.htmlClasses.activeClass).attr("disabled",!1),t.removeClass(s.htmlClasses.visibleClass).addClass(s.htmlClasses.hiddenClass).attr("aria-hidden",!0),t.eq(i).removeClass(s.htmlClasses.hiddenClass).addClass(s.htmlClasses.visibleClass).attr("aria-hidden",!1).focus()}))}};e(".amotos-car-multi-step").length>0&&s.init()}(jQuery);