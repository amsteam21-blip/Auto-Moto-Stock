var AMOTOS_STRIPE=AMOTOS_STRIPE||{};!function(a){"use strict";AMOTOS_STRIPE={init:function(){this.setupForm()},setupForm:function(){var e=a(".amotos-stripe-form");if(0!==e.length){var n=e.attr("id"),t=amotos_stripe_vars[n],i=null,r=e.find(".amotos-stripe-button");r.length&&(i=StripeCheckout.configure({key:t.key,token:function(n,t){a("<input>").attr({type:"hidden",name:"stripeToken",value:n.id}).appendTo(e),a("<input>").attr({type:"hidden",name:"stripeTokenType",value:n.type}).appendTo(e),n.email&&a("<input>").attr({type:"hidden",name:"stripeEmail",value:n.email}).appendTo(e),e.submit()}}),r.on("click",(function(a){a.preventDefault(),i.open(t.params)}))),window.addEventListener("popstate",(function(){null!=i&&i.close()}))}}},a(document).ready((function(){if(AMOTOS_STRIPE.init(),"undefined"!=typeof amotos_payment_vars){var e=amotos_payment_vars.ajax_url,n=amotos_payment_vars.processing_text;a("#amotos_payment_listing").on("click",(function(){var e=a("input[name='amotos_payment_method']:checked").val(),n=a("input[name='amotos_payment_for']:checked").val(),r=a("#amotos_car_id").val();"paypal"==e?t(r,n):"stripe"==e?a("#amotos_stripe_per_listing button").trigger("click"):"wire_transfer"==e&&i(r,n)})),a("#amotos_upgrade_listing").on("click",(function(){var e=a("input[name='amotos_payment_for']:checked").val(),n=a("input[name='amotos_payment_method']:checked").val(),r=a("#amotos_car_id").val();"paypal"==n?t(r,e):"stripe"==n?a("#amotos_stripe_upgrade_listing button").trigger("click"):"wire_transfer"==n&&i(r,e)}));var t=function(t,i){a.ajax({type:"post",url:e,data:{action:"amotos_paypal_payment_per_listing_ajax",car_id:t,payment_for:i,amotos_security_payment:a("#amotos_security_payment").val()},beforeSend:function(){AMOTOS.show_loading(n)},success:function(a){window.location.href=a}})},i=function(t,i){a.ajax({type:"POST",url:e,data:{action:"amotos_wire_transfer_per_listing_ajax",car_id:t,payment_for:i,amotos_security_payment:a("#amotos_security_payment").val()},beforeSend:function(){AMOTOS.show_loading(n)},success:function(a){window.location.href=a}})};a("#amotos_payment_package").on("click",(function(e){var n=a("input[name='amotos_payment_method']:checked").val(),t=a("input[name='amotos_package_id']").val();"paypal"==n?r(t):"stripe"==n?a("#amotos_stripe_per_package button").trigger("click"):"wire_transfer"==n&&s(t)}));var r=function(t){a.ajax({type:"POST",url:e,data:{action:"amotos_paypal_payment_per_package_ajax",package_id:t,amotos_security_payment:a("#amotos_security_payment").val()},beforeSend:function(){AMOTOS.show_loading(n)},success:function(a){window.location.href=a}})},s=function(t){a.ajax({type:"POST",url:e,data:{action:"amotos_wire_transfer_per_package_ajax",package_id:t,amotos_security_payment:a("#amotos_security_payment").val()},beforeSend:function(){AMOTOS.show_loading(n)},success:function(a){window.location.href=a}})};a("#amotos_free_package").on("click",(function(){var t=a("input[name='amotos_package_id']").val();a.ajax({type:"POST",url:e,data:{action:"amotos_free_package_ajax",package_id:t,amotos_security_payment:a("#amotos_security_payment").val()},beforeSend:function(){AMOTOS.show_loading(n)},success:function(a){window.location.href=a}})}))}}))}(jQuery);