var AMOTOS=AMOTOS||{};!function(a){"use strict";var t=amotos_main_vars.ajax_url,s=amotos_main_vars.confirm_yes_text,e=amotos_main_vars.confirm_no_text,o=amotos_main_vars.loading_text,n=amotos_main_vars.sending_text,i=amotos_main_vars.decimals,r=amotos_main_vars.dec_point,c=amotos_main_vars.thousands_sep;AMOTOS={_ajax_process:!1,init:function(){this.register_pattern_validator(),this.show_wire_transfer_info(),this.view_gallery(),this.favorite(),this.tooltip(),this.car_paging(),this.move_link_to_carousel(),this.execute_nav(),this.execute_slider_nav(),this.sc_sync_car_carousel(),this.light_gallery(),this.contact_manager_by_email(),this.tab_collapse(),this.start_rating(),this.submit_rating(),this.loan_calculator(),this.login(),this.register(),this.showHidePassword()},show_wire_transfer_info:function(){a("input[type=radio][name=amotos_payment_method]").on("change",(function(){"wire_transfer"==a(this).val()?a(".amotos-wire-transfer-info").show():a(".amotos-wire-transfer-info").hide()}))},register_pattern_validator:function(){a.validator.addMethod("pattern",(function(a,t,s){return!!this.optional(t)||("string"==typeof s&&(s=new RegExp("^(?:"+s+")$")),s.test(a))}),"Invalid format.")},number_format:function(a,t){t=void 0!==t?t:i,a=(a+"").replace(/[^0-9+\-Ee.]/g,"");var s=isFinite(+a)?+a:0,e=isFinite(+t)?Math.abs(t):0,o=void 0===c?",":c,n=void 0===r?".":r,l="";return l=(e?function(a,t){var s=Math.pow(10,t);return""+Math.round(a*s)/s}(s,e):""+Math.round(s)).split("."),l[0].length>3&&(l[0]=l[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,o)),(l[1]||"").length<e&&(l[1]=l[1]||"",l[1]+=new Array(e-l[1].length+1).join("0")),l.join(n)},tooltip:function(){a('[data-toggle="tooltip"]').each((function(){var t={container:a(this).parent()};a(this).tooltip(t)}))},login_modal:function(){a("#amotos_signin_modal").modal("show")},get_page_number_from_href:function(a){var t="",s=/paged=\d+/gi;return new RegExp(s).test(a)?t=new RegExp(s).exec(a):(s=/page\/\d+/gi,t=new RegExp(s).test(a)?new RegExp(s).exec(a):t),s=/\d+/g,new RegExp(s).test(t)?new RegExp(s).exec(t)[0]:1},view_gallery:function(){var s=this;a(document).on("click",".car-view-gallery",(function(e){if(e.preventDefault(),!s._ajax_process){s._ajax_process=!0;var o=a(this),n=o.attr("data-car-id"),i=o.find("i"),r=o.data("gallery"),c=o.closest(".car-inner");i.length&&i.data("class",i.attr("class")),void 0!==r?(s._ajax_process=!1,o.lightGallery({hash:!1,thumbnail:!1,dynamic:!0,dynamicEl:r})):a.ajax({type:"post",url:t,dataType:"json",data:{action:"amotos_view_gallery_ajax",car_id:n},beforeSend:function(){c.addClass("car-active-hover"),i.attr("class","fa fa-spinner fa-spin")},success:function(a){if(a.success){for(var t=[],e=0;e<a.data.length;e++)t.push({src:a.data[e]});void 0===r&&o.data("gallery",t),o.lightGallery({hash:!1,thumbnail:!1,dynamic:!0,dynamicEl:t})}c.removeClass("car-active-hover"),s._ajax_process=!1,i.attr("class",i.data("class"))},error:function(){s._ajax_process=!1,i.attr("class",i.data("class")),c.removeClass("car-active-hover")}})}}))},favorite:function(){a(document).on("click",".car-favorite",(function(s){if(s.preventDefault(),!a(this).hasClass("on-handle")){var e=a(this).addClass("on-handle"),o=e.closest(".car-inner").addClass("car-active-hover"),n=e.attr("data-car-id"),i=e.attr("data-title-not-favorite"),r=e.attr("data-icon-not-favorite"),c=e.attr("data-title-favorited"),l=e.attr("data-icon-favorited");a.ajax({type:"post",url:t,dataType:"json",data:{action:"amotos_favorite_ajax",car_id:n},beforeSend:function(){e.children("i").addClass("fa-spinner fa-spin")},success:function(a){void 0!==a.added&&-1!=a.added||AMOTOS.login_modal(),1==a.added?(e.children("i").removeClass(r).addClass(l),e.attr("title",c)):0==a.added&&(e.children("i").removeClass(l).addClass(r),e.attr("title",i)),e.children("i").removeClass("fa-spinner fa-spin"),e.removeClass("on-handle"),o.removeClass("car-active-hover")},error:function(){e.children("i").removeClass("fa-spinner fa-spin"),e.removeClass("on-handle"),o.removeClass("car-active-hover")}})}}))},light_gallery:function(){a("[data-rel='amotos_light_gallery']").each((function(){var t=a(this),s=t.data("gallery-id");t.on("click",(function(e){e.preventDefault();var o=[],n=0,i=a(this).attr("href"),r=a(this).data("thumb-src");void 0!==s&&(a('[data-gallery-id="'+s+'"]').each((function(t){var s=a(this).attr("href"),e=a(this).data("thumb-src"),c=a(this).attr("title");s==i&&e==r&&(n=t),void 0===c&&(c=""),o.push({src:s,downloadUrl:s,thumb:e,subHtml:c})})),t.lightGallery({hash:!1,galleryId:s,dynamic:!0,dynamicEl:o,thumbWidth:80,index:n,loadYoutubeThumbnail:!1}))}))})),a("a.amotos-view-video").on("click",(function(t){t.preventDefault();var s=a(this).attr("data-src");a(this).lightGallery({dynamic:!0,dynamicEl:[{src:s,thumb:"",subHtml:""}]})}))},show_loading:function(t){"undefined"!=t&&""!=t&&null!=t||(t=o);var s=wp.template("amotos-processing-template");a("body").append(s({ico:"fa fa-spinner fa-spin",text:t}))},change_loading_status:function(t,s){a("i",".amotos-processing").removeClass("fa-spinner fa-spin").addClass(t),a("span",".amotos-processing").text(s)},close_loading:function(t){void 0!==t&&null!=t||(t=500),0==t?a(".amotos-processing").remove():setTimeout((function(){a(".amotos-processing").fadeOut((function(){a(".amotos-processing").remove()}))}),t)},popup_alert:function(t,s,e){var o=wp.template("amotos-dialog-template");a("body").append(o({ico:t,message:e})),a("#amotos-dialog-popup").dialog({title:s,resizable:!1,closeOnEscape:!0,modal:!0,buttons:{Ok:function(){a(this).dialog("close"),a(this).dialog("destroy").remove()}}})},confirm_dialog:function(t,o,n,i){var r=wp.template("amotos-dialog-template");a("body").append(r({ico:"fa fa-question-circle",message:o})),a("#amotos-dialog-popup").dialog({title:t,resizable:!1,closeOnEscape:!0,modal:!0,buttons:[{text:s,click:function(){n&&n(),a(this).dialog("destroy").remove()}},{text:e,click:function(){i&&i(),a(this).dialog("close"),a(this).dialog("destroy").remove()}}]})},set_item_effect:function(t,s){if("hide"==s&&(t.css("transition","opacity 1.5s linear, transform 1s"),t.css("-webkit-transition","opacity 1.5s linear, transform 1s"),t.css("-moz-transition","opacity 1.5s linear, transform 1s"),t.css("-ms-transition","opacity 1.5s linear, transform 1s"),t.css("-o-transition","opacity 1.5s linear, transform 1s"),t.css("opacity",0),t.css("transform","scale(0.2)"),t.css("-ms-transform","scale(0.2)"),t.css("-webkit-transform","scale(0.2)")),"show"==s)for(var e=0;e<t.length;e++)!function(s){setTimeout((function(){a(t[s]).css("opacity",1),a(t[s]).css("transform","scale(1)"),a(t[s]).css("-ms-transform","scale(1)"),a(t[s]).css("-webkit-transform","scale(1)")}),10*e)}(e)},select_term:function(){var t=a("select.car-filter-mb");t.off(),a(t).on("change",(function(t){var s=a(this);s.attr("disabled","disabled"),t.preventDefault();var e=a("option:selected",s).attr("value");s.parent().prev().children('[data-filter="'+e+'"]').click()}))},contact_manager_by_email:function(){var s=this;a(".amotos__btn-submit-contact-form").on("click",(function(e){e.preventDefault();var o=a(this).closest("form");if(!1!==o[0].checkValidity()){var i=o.find(".amotos__message");s._ajax_process||(s._ajax_process=!0,a.ajax({type:"post",url:t,dataType:"json",data:o.serialize(),beforeSend:function(){i.html('<span class="success text-success"> '+n+"</span>")},success:function(a){a.success?i.html('<span class="success text-success"><i class="fa fa-check"></i> '+a.message+"</span>"):("function"==typeof amotos_reset_recaptcha&&amotos_reset_recaptcha(),i.html('<span class="error text-danger"><i class="fa fa-close"></i> '+a.message+"</span>"))},complete:function(){s._ajax_process=!1},error:function(){}}))}else o.addClass("was-validated")}))},car_paging:function(){var t=!0;a(".paging-navigation",".car-paging-wrap").each((function(){a("a",a(this)).off("click").on("click",(function(s){if(s.preventDefault(),t){t=!1;var e=a(this),o=e.attr("href"),n=AMOTOS.get_page_number_from_href(o),i=e.closest(".car-paging-wrap"),r=e.closest(".amotos-car").find(".car-content");a.ajax({url:i.data("admin-url"),data:{action:"amotos_car_paging_ajax",layout:i.data("layout"),items_amount:i.data("items-amount"),columns:i.data("columns"),image_size:i.data("image-size"),columns_gap:i.data("columns-gap"),view_all_link:i.data("view-all-link"),paged:n,car_type:i.data("car-type"),car_status:i.data("car-status"),car_styling:i.data("car-styling"),car_city:i.data("car-city"),car_state:i.data("car-state"),car_neighborhood:i.data("car-neighborhood"),car_label:i.data("car-label"),car_featured:i.data("car-featured"),author_id:i.data("author-id"),manager_id:i.data("manager-id")},success:function(s){var e=a(".car-item",s),o=a(".car-paging-wrap",s);r.css("opacity",0),r.html(e),AMOTOS.set_item_effect(e,"hide");var n=r.offset().top-30;a("html,body").animate({scrollTop:+n+"px"},500),r.css("opacity",1),r.imagesLoaded((function(){e=a(".car-item",r),AMOTOS.set_item_effect(e,"show"),r.closest(".amotos-car").find(".car-paging-wrap").html(o.html()),AMOTOS.car_paging(),AMOTOS.car_paging_control(),AMOTOS.favorite(),AMOTOS.tooltip(),AMOTOS_Compare.register_event_compare()})),t=!0},error:function(){t=!0}})}}))}))},car_paging_control:function(){a(".paging-navigation",".amotos-car").each((function(){var t=a(this);0===t.find("a.next").length?t.addClass("next-disable"):t.removeClass("next-disable")}))},move_link_to_carousel:function(){a(".car-carousel").each((function(){var t=a(this);a(".owl-carousel",t).on("owlInitialized",(function(){if(null!=t.data("view-all-link")&&(t.children(".owl-loaded").hasClass("owl-nav-top-right")||t.children(".owl-loaded").hasClass("owl-nav-bottom-center"))){var a=t.find(".view-all-link");a.length>0&&!t.find(".owl-nav").hasClass("disabled")&&(a.removeClass("mg-top-60 sm-mg-top-40"),t.find(".owl-nav").addClass("has-view-all"),t.find(".owl-nav").append(a[0].outerHTML),a.remove())}t.hasClass("owl-move-nav-par-with-heading")&&t.find(".amotos-heading").length>0&&!t.find(".amotos-heading").hasClass("heading-contain-owl-nav")&&(t.find(".amotos-heading").addClass("heading-contain-owl-nav owl-nav-inline"),t.find(".has-view-all").length>0&&t.find(".amotos-heading").addClass("owl-nav-size-sm"),t.find(".owl-nav").insertAfter(t.find(".amotos-heading").children("h2")))}))}))},execute_nav:function(){a(".amotos-car-carousel").each((function(){var t=a(this),s=a(".navigation-wrap",t),e=a(".owl-carousel .car-item",t);AMOTOS.amotos_calc_column_padding(s,e),a(".owl-carousel",t).on("owlInitialized",(function(){var t=a(this),e=a(".owl-nav",t);s.length>0&&e.length>0&&e.detach().appendTo(s),s.addClass("owl-nav-inline"),AMOTOS.amotos_calc_column_padding(s,a(".car-item",t))}))}))},amotos_calc_column_padding:function(a,t){return;if(a.height()<t.height()){var s=Math.floor((t.height()-a.height())/2);a.css({"padding-top":s+"px","padding-bottom":s+"px"})}},execute_slider_nav:function(){return;a(".amotos-car-slider.navigation-middle").each((function(){AMOTOS.amotos_calc_nav_top(a(".owl-carousel",a(this))),a(".owl-carousel",a(this)).on("owlInitialized",(function(){var t=a(this);a(".owl-nav",t).addClass("container"),setTimeout((function(){AMOTOS.amotos_calc_nav_top(t)}),20)}))}))},amotos_calc_nav_top:function(t){var s=a(".owl-nav",t),e=a(".car-item",t).outerHeight(),o=a(".block-center-inner",t).outerHeight(),n=Math.floor((e-o)/2);s.css("top",n+"px")},sc_sync_car_carousel:function(){var t=this;a(".pagination-image.amotos-car-slider").each((function(s,e){t.sync_car_carousel(a(e))}))},sync_car_carousel:function(t){var s=a("body").hasClass("rtl"),e=t.find(".car-content-slider"),o=t.find(".car-image-slider");e.owlCarousel({items:1,navElement:"div",autoHeight:!0,nav:!1,dots:!1,loop:!1,smartSpeed:500,rtl:s}).on("changed.owl.carousel",(function(a){var t=a.item.index;o.find(".owl-item").removeClass("current").eq(t).addClass("current");var s=o.find(".owl-item.active").length-1,e=o.find(".owl-item.active").first().index(),n=o.find(".owl-item.active").last().index();t>n&&o.data("owl.carousel").to(t,500,!0);t<e&&o.data("owl.carousel").to(t-s,500,!0)})),o.on("initialized.owl.carousel",(function(){o.find(".owl-item").eq(0).addClass("current")})).owlCarousel({nav:!1,navElement:"div",dots:!1,rtl:s,margin:10,responsive:{992:{items:4},768:{items:3},480:{items:2},0:{items:1}}}).on("changed.owl.carousel",(function(a){var t=a.item.index;e.data("owl.carousel").to(t,500,!0)})),o.on("click",".owl-item",(function(t){if(t.preventDefault(),!a(this).hasClass("current")){var s=a(this).index();e.data("owl.carousel").to(s,500,!0)}}))},tab_collapse:function(){a("[data-tabcollapse]").tabCollapse()},start_rating:function(){var t=a("body").hasClass("rtl");a(".amotos__start-rating").each((function(){var s=a(this),e={step:1,showClear:!1,showCaption:!1,filledStar:'<i class="fa fa-star"></i>',emptyStar:'<i class="fa fa-star-o"></i>',clearButton:'<i class="fa fa-minus-circle"></i>',rtl:t},o=a.extend({},e,s.data("options"));s.rating(o)}))},submit_rating:function(){var s=this;a(".amotos__btn-submit-rating").on("click",(function(e){e.preventDefault();var o=a(this),n=o.closest("form");!1!==n[0].checkValidity()?s._ajax_process||(s._ajax_process=!0,a.ajax({type:"POST",url:t,data:n.serialize(),dataType:"json",beforeSend:function(){o.children("i").remove(),o.append('<i class="fa fa-spinner fa-spin"></i>')},success:function(a){a.success&&window.location.reload()},complete:function(){s._ajax_process=!1,o.children("i").removeClass("fa fa-spinner fa-spin"),o.children("i").addClass("fa fa-check")}})):n.addClass("was-validated")}))},loan_calculator:function(){a(".amotos__btn-submit-loan-calculator").on("click",(function(t){t.preventDefault();var s=a(this).closest("form");if(!1!==s[0].checkValidity()){var e=s.find('[name="sale_price"]'),o=s.find('[name="down_payment"]'),n=s.find('[name="term_years"]'),i=s.find('[name="interest_rate"]'),r=e.val(),c=o.val(),l=parseInt(n.val(),10),d=parseFloat(i.val(),10)/100,m=d/12,f=d/26,u=d/52,p=12*l,_=26*l,h=52*l,v=r-c,g=parseFloat(v*m/(1-Math.pow(1+m,-p))).toFixed(2),w=parseFloat(v*f/(1-Math.pow(1+f,-_))).toFixed(2),y=parseFloat(v*u/(1-Math.pow(1+u,-h))).toFixed(2);"NaN"===g&&(g=0),"NaN"===w&&(w=0),"NaN"===y&&(y=0),v=AMOTOS.number_format(v),g=AMOTOS.number_format(g),w=AMOTOS.number_format(w),y=AMOTOS.number_format(y),"before"===amotos_main_vars.currency_position?(v=amotos_main_vars.currency+v,g=amotos_main_vars.currency+g,w=amotos_main_vars.currency+w,y=amotos_main_vars.currency+y):(v+=amotos_main_vars.currency,g+=amotos_main_vars.currency,w+=amotos_main_vars.currency,y+=amotos_main_vars.currency);var x=wp.template("amotos__mc_template")({loan_amount:v,years:l,monthly_payment:g,bi_weekly_payment:w,weekly_payment:y});s.find(".amotos__mc-result").length&&s.find(".amotos__mc-result").remove(),s.append(x)}else s.addClass("was-validated")}))},login:function(){var s=this;a(".amotos-login-button").on("click",(function(e){e.preventDefault();var n=a(this),i=n.closest("form");if(!1!==i[0].checkValidity()){if(!s._ajax_process){s._ajax_process=!0;var r=i.find(".amotos_messages"),c=n.data("redirect-url");a.ajax({type:"post",url:t,dataType:"json",data:i.serialize(),beforeSend:function(){r.html('<span class="success text-success"> '+o+"</span>")},success:function(a){a.success?(r.html('<span class="success text-success"><i class="fa fa-check"></i> '+a.message+"</span>"),""===c?window.location.reload():window.location.href=c):("function"==typeof amotos_reset_recaptcha&&amotos_reset_recaptcha(),r.html('<span class="error text-danger"><i class="fa fa-close"></i> '+a.message+"</span>"))},complete:function(){s._ajax_process=!1},error:function(){}})}}else i.addClass("was-validated")})),a(".amotos_forgetpass").on("click",(function(e){e.preventDefault();var n=a(this).closest("form");if(!1!==n[0].checkValidity()){if(!s._ajax_process){s._ajax_process=!0;var i=n.find(".amotos_messages");a.ajax({type:"post",url:t,dataType:"json",data:n.serialize(),beforeSend:function(){i.html('<span class="success text-success"> '+o+"</span>")},success:function(a){a.success?i.html('<span class="success text-success"><i class="fa fa-check"></i> '+a.message+"</span>"):("function"==typeof amotos_reset_recaptcha&&amotos_reset_recaptcha(),i.html('<span class="error text-danger"><i class="fa fa-close"></i> '+a.message+"</span>"))},complete:function(){s._ajax_process=!1},error:function(){}})}}else n.addClass("was-validated")})),a(".amotos-reset-password").on("click",(function(t){t.preventDefault();var s=a(this).closest(".amotos-login-wrap"),e=s.next(".amotos-reset-password-wrap");s.slideUp("slow"),e.slideDown("slow"),e.find(".reset_password_user_login").focus()})),a(".amotos-back-to-login").on("click",(function(t){t.preventDefault();var s=a(this).closest(".amotos-reset-password-wrap"),e=s.prev(".amotos-login-wrap");s.slideUp("slow"),e.slideDown("slow"),e.find(".login_user_login").focus()})),a("#amotos_signin_modal").on("shown.bs.modal hide.bs.modal",(function(){a(".amotos-back-to-login",a("#amotos_signin_modal")).click()}))},register:function(){var s=this;a(".amotos-register-button").on("click",(function(e){e.preventDefault();var n=a(this),i=n.closest("form");if(!1!==i[0].checkValidity()){if(!s._ajax_process){s._ajax_process=!0;var r=i.find(".amotos_messages"),c=n.data("redirect-url");a.ajax({type:"post",url:t,dataType:"json",data:i.serialize(),beforeSend:function(){r.html('<span class="success text-success"> '+o+"</span>")},success:function(t){t.success?(r.html('<span class="success text-success"><i class="fa fa-check"></i> '+t.message+"</span>"),""===c?setTimeout((function(){a("#amotos_login_modal_tab").click()}),4e3):window.location.href=c):("function"==typeof amotos_reset_recaptcha&&amotos_reset_recaptcha(),r.html('<span class="error text-danger"><i class="fa fa-close"></i> '+t.message+"</span>"))},complete:function(){s._ajax_process=!1},error:function(){}})}}else i.addClass("was-validated")}))},showHidePassword:function(){a(".amotos__show-password").on("click",(function(t){t.preventDefault();var s=a(this).closest(".input-group").find(".amotos__password"),e=a(this).find("i");"password"===s.attr("type")?(s.attr("type","text"),e.removeClass("fa-eye"),e.addClass("fa-eye-slash")):(s.attr("type","password"),e.removeClass("fa-eye-slash"),e.addClass("fa-eye"))}))}},a(document).ready((function(){AMOTOS.init()})),a(window).resize((function(){setTimeout(AMOTOS.execute_nav,20),setTimeout((function(){AMOTOS.execute_slider_nav(),AMOTOS.sc_sync_car_carousel()}),10)}))}(jQuery);